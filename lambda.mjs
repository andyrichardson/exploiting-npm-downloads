import { spawnSync } from 'child_process';
const TRIGGER_PROBABILITY = 0.8;


export const handler = ({ package }) => {
  console.log(`Rolling a die to see if we run this time (p ${TRIGGER_PROBABILITY})`);
  
  if (Math.random() > TRIGGER_PROBABILITY) {
    console.log("Roll fail - skipping run");
  }

  console.log("Roll success!");
  const res = spawnSync('npm', ['i', package, '--no-cache'], { stdio: 'inherit' });
  console.log(`Install command completed with exit code '${res.status}'`)
}